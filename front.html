<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Course Registration</title>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.1.2/dist/tailwind.min.css" rel="stylesheet">
</head>

<body class="bg-gray-100 p-8">
  <div class="max-w-2xl mx-auto bg-white p-8 shadow-lg rounded-lg">
    <h1 class="text-3xl font-semibold text-center mb-6">Course Registration</h1>

    <form id="registrationForm">
      <div class="mb-4">
        <label for="fullName" class="block text-sm font-medium text-gray-700">Full Name</label>
        <input type="text" id="fullName" name="fullName" class="mt-1 p-2 w-full border border-gray-300 rounded-md" required />
      </div>

      <div class="mb-4">
        <label for="email" class="block text-sm font-medium text-gray-700">Email</label>
        <input type="email" id="email" name="email" class="mt-1 p-2 w-full border border-gray-300 rounded-md" required />
      </div>

      <div class="mb-4">
        <label for="phoneNumber" class="block text-sm font-medium text-gray-700">Phone Number</label>
        <input type="text" id="phoneNumber" name="phoneNumber" class="mt-1 p-2 w-full border border-gray-300 rounded-md" required />
      </div>

      <div class="mb-4">
        <label for="collegeName" class="block text-sm font-medium text-gray-700">College Name</label>
        <input type="text" id="collegeName" name="collegeName" class="mt-1 p-2 w-full border border-gray-300 rounded-md" required />
      </div>

      <div class="mb-4">
        <label for="course" class="block text-sm font-medium text-gray-700">Course</label>
        <select id="course" name="course" class="mt-1 p-2 w-full border border-gray-300 rounded-md" required>
          <option value="Diploma">Diploma</option>
          <option value="B.Arch">B.Arch</option>
          <option value="M.Arch">M.Arch</option>
        </select>
      </div>

      <div class="mb-4">
        <label for="registrationType" class="block text-sm font-medium text-gray-700">Registration Type</label>
        <select id="registrationType" name="registrationType" class="mt-1 p-2 w-full border border-gray-300 rounded-md" required>
          <option value="Individual">Individual</option>
          <option value="Team">Team</option>
        </select>
      </div>

      <div id="teamSizeSection" class="mb-4 hidden">
        <label for="teamSize" class="block text-sm font-medium text-gray-700">Team Size</label>
        <input type="number" id="teamSize" name="teamSize" class="mt-1 p-2 w-full border border-gray-300 rounded-md" />
      </div>

      <div id="teamMembersSection" class="mb-4 hidden">
        <label for="teamMembers" class="block text-sm font-medium text-gray-700">Team Members</label>
        <div id="teamMembers" class="space-y-4">
          <!-- Team Member Fields will go here -->
        </div>
      </div>

      <button type="submit" class="w-full bg-blue-600 text-white py-2 rounded-md">Register</button>
    </form>
  </div>

  <script>
    // Dynamically show/hide team size and team members based on registration type
    const registrationTypeSelect = document.getElementById("registrationType");
    const teamSizeSection = document.getElementById("teamSizeSection");
    const teamMembersSection = document.getElementById("teamMembersSection");

    registrationTypeSelect.addEventListener("change", function () {
      const registrationType = registrationTypeSelect.value;

      if (registrationType === "Team") {
        teamSizeSection.classList.remove("hidden");
        teamMembersSection.classList.remove("hidden");
      } else {
        teamSizeSection.classList.add("hidden");
        teamMembersSection.classList.add("hidden");
      }
    });

    // Handle form submission (send data to backend)
    const form = document.getElementById("registrationForm");

    form.addEventListener("submit", async (event) => {
      event.preventDefault();

      const formData = new FormData(form);
      const data = {};

      formData.forEach((value, key) => {
        data[key] = value;
      });

      try {
        const response = await fetch("/api/register", {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
          },
          body: JSON.stringify(data),
        });

        const result = await response.json();
        if (result.success) {
          window.location.href = result.paymentLink; // Redirect to Razorpay payment page
        } else {
          alert("Registration failed");
        }
      } catch (error) {
        console.error("Error:", error);
        alert("An error occurred during registration.");
      }
    });
  </script>
</body>

</html>
